<view class="publish-page data-v-c520b992"><scroll-view class="content-scroll data-v-c520b992" style="{{'height:'+('calc(100vh - 120px - env(safe-area-inset-bottom))')+';'}}" scroll-y="true"><view class="content-container data-v-c520b992"><view class="title-section data-v-c520b992"><input class="title-input data-v-c520b992" placeholder="填写标题，让你的动态更吸引人（选填）" maxlength="50" data-event-opts="{{[['input',[['__set_model',['$0','title','$event',[]],['postForm']]]]]}}" value="{{postForm.title}}" bindinput="__e"/><text class="title-count data-v-c520b992">{{$root.g0+"/50"}}</text></view><view class="content-section data-v-c520b992"><textarea class="content-input data-v-c520b992" placeholder="分享你的想法、经历或见闻..." maxlength="1000" auto-height="{{true}}" show-confirm-bar="{{false}}" data-event-opts="{{[['input',[['__set_model',['$0','content','$event',[]],['postForm']]]]]}}" value="{{postForm.content}}" bindinput="__e"></textarea><text class="content-count data-v-c520b992">{{$root.g1+"/1000"}}</text></view><view class="media-section data-v-c520b992"><view class="media-grid data-v-c520b992"><block wx:for="{{selectedMedia}}" wx:for-item="media" wx:for-index="index" wx:key="index"><view class="media-item data-v-c520b992"><view class="media-wrapper data-v-c520b992"><block wx:if="{{media.type==='image'}}"><image class="media-preview data-v-c520b992" src="{{media.url}}" mode="aspectFill" data-event-opts="{{[['tap',[['previewMedia',[index]]]]]}}" bindtap="__e"></image></block><block wx:else><block wx:if="{{media.type==='video'}}"><view class="video-preview data-v-c520b992"><image class="video-thumbnail data-v-c520b992" src="{{media.thumbnail}}" mode="aspectFill"></image><view class="video-play-icon data-v-c520b992"><u-icon vue-id="{{'108544af-1-'+index}}" name="play-circle-fill" size="40" color="rgba(255,255,255,0.8)" class="data-v-c520b992" bind:__l="__l"></u-icon></view></view></block></block><view data-event-opts="{{[['tap',[['removeMedia',[index]]]]]}}" class="media-delete data-v-c520b992" bindtap="__e"><u-icon vue-id="{{'108544af-2-'+index}}" name="close" size="16" color="#fff" class="data-v-c520b992" bind:__l="__l"></u-icon></view><block wx:if="{{media.uploading}}"><view class="media-status data-v-c520b992"><u-loading-icon vue-id="{{'108544af-3-'+index}}" mode="circle" size="20" color="#3b5598" class="data-v-c520b992" bind:__l="__l"></u-loading-icon></view></block></view></view></block><block wx:if="{{$root.g2<9}}"><view data-event-opts="{{[['tap',[['showMediaOptions',['$event']]]]]}}" class="media-item add-media data-v-c520b992" bindtap="__e"><view class="add-media-icon data-v-c520b992"><u-icon vue-id="108544af-4" name="camera" size="40" color="#ccc" class="data-v-c520b992" bind:__l="__l"></u-icon></view><text class="add-media-text data-v-c520b992">添加图片/视频</text></view></block></view><text class="media-tip data-v-c520b992">最多上传9张图片或1个视频</text></view><view class="topic-section data-v-c520b992"><text class="section-title data-v-c520b992">添加话题</text><view class="topic-input-wrapper data-v-c520b992"><input class="topic-input data-v-c520b992" placeholder="#输入话题标签" data-event-opts="{{[['confirm',[['addTopic',['$event']]]],['input',[['__set_model',['','topicInput','$event',[]]]]]]}}" value="{{topicInput}}" bindconfirm="__e" bindinput="__e"/><view data-event-opts="{{[['tap',[['addTopic',['$event']]]]]}}" class="add-topic-btn data-v-c520b992" bindtap="__e">添加</view></view><block wx:if="{{$root.g3>0}}"><view class="topic-list data-v-c520b992"><block wx:for="{{postForm.topics}}" wx:for-item="topic" wx:for-index="index" wx:key="index"><view class="topic-tag data-v-c520b992"><text class="topic-text data-v-c520b992">{{"#"+topic}}</text><view data-event-opts="{{[['tap',[['removeTopic',[index]]]]]}}" class="topic-remove data-v-c520b992" bindtap="__e"><u-icon vue-id="{{'108544af-5-'+index}}" name="close" size="12" color="#666" class="data-v-c520b992" bind:__l="__l"></u-icon></view></view></block></view></block></view><view class="settings-section data-v-c520b992"><view class="setting-item data-v-c520b992"><text class="setting-label data-v-c520b992">谁可以看</text><view data-event-opts="{{[['tap',[['showPrivacyOptions',['$event']]]]]}}" class="setting-value data-v-c520b992" bindtap="__e"><text class="setting-text data-v-c520b992">{{$root.m0}}</text><u-icon vue-id="108544af-6" name="arrow-right" size="16" color="#999" class="data-v-c520b992" bind:__l="__l"></u-icon></view></view><view class="setting-item data-v-c520b992"><text class="setting-label data-v-c520b992">允许评论</text><switch checked="{{postForm.allowComment}}" color="#3b5598" data-event-opts="{{[['change',[['onCommentChange',['$event']]]]]}}" bindchange="__e" class="data-v-c520b992"></switch></view></view><view class="bottom-placeholder data-v-c520b992"></view></view></scroll-view><view class="bottom-bar data-v-c520b992" style="{{'padding-bottom:'+('calc(20rpx + env(safe-area-inset-bottom))')+';'}}"><view data-event-opts="{{[['tap',[['submitPost',['$event']]]]]}}" class="{{['publish-btn','data-v-c520b992',(!canPublish)?'disabled':'',(submitting)?'loading':'']}}" bindtap="__e"><block wx:if="{{submitting}}"><u-loading-icon vue-id="108544af-7" mode="circle" size="18" color="#fff" class="data-v-c520b992" bind:__l="__l"></u-loading-icon></block><block wx:else><text class="publish-text data-v-c520b992">发布</text></block></view></view><u-popup vue-id="108544af-8" show="{{showMediaPicker}}" mode="bottom" round="{{10}}" safe-area-inset-bottom="{{true}}" class="data-v-c520b992" bind:__l="__l" vue-slots="{{['default']}}"><view class="media-picker data-v-c520b992"><view class="picker-header data-v-c520b992"><text class="picker-title data-v-c520b992">选择媒体</text><view data-event-opts="{{[['tap',[['e0',['$event']]]]]}}" class="picker-close data-v-c520b992" bindtap="__e"><u-icon vue-id="{{('108544af-9')+','+('108544af-8')}}" name="close" size="20" color="#999" class="data-v-c520b992" bind:__l="__l"></u-icon></view></view><view class="picker-options data-v-c520b992"><view data-event-opts="{{[['tap',[['chooseImage',['$event']]]]]}}" class="picker-option data-v-c520b992" bindtap="__e"><u-icon vue-id="{{('108544af-10')+','+('108544af-8')}}" name="photo" size="24" color="#3b5598" class="data-v-c520b992" bind:__l="__l"></u-icon><text class="option-text data-v-c520b992">从相册选择</text></view><view data-event-opts="{{[['tap',[['takePhoto',['$event']]]]]}}" class="picker-option data-v-c520b992" bindtap="__e"><u-icon vue-id="{{('108544af-11')+','+('108544af-8')}}" name="camera" size="24" color="#3b5598" class="data-v-c520b992" bind:__l="__l"></u-icon><text class="option-text data-v-c520b992">拍照</text></view><block wx:if="{{!hasVideo}}"><view data-event-opts="{{[['tap',[['chooseVideo',['$event']]]]]}}" class="picker-option data-v-c520b992" bindtap="__e"><u-icon vue-id="{{('108544af-12')+','+('108544af-8')}}" name="play-circle" size="24" color="#3b5598" class="data-v-c520b992" bind:__l="__l"></u-icon><text class="option-text data-v-c520b992">选择视频</text></view></block><block wx:if="{{!hasVideo}}"><view data-event-opts="{{[['tap',[['recordVideo',['$event']]]]]}}" class="picker-option data-v-c520b992" bindtap="__e"><u-icon vue-id="{{('108544af-13')+','+('108544af-8')}}" name="videocam" size="24" color="#3b5598" class="data-v-c520b992" bind:__l="__l"></u-icon><text class="option-text data-v-c520b992">录制视频</text></view></block></view></view></u-popup><u-popup vue-id="108544af-14" show="{{showPrivacyPicker}}" mode="bottom" round="{{10}}" safe-area-inset-bottom="{{true}}" class="data-v-c520b992" bind:__l="__l" vue-slots="{{['default']}}"><view class="privacy-picker data-v-c520b992"><view class="picker-header data-v-c520b992"><text class="picker-title data-v-c520b992">谁可以看</text><view data-event-opts="{{[['tap',[['e1',['$event']]]]]}}" class="picker-close data-v-c520b992" bindtap="__e"><u-icon vue-id="{{('108544af-15')+','+('108544af-14')}}" name="close" size="20" color="#999" class="data-v-c520b992" bind:__l="__l"></u-icon></view></view><view class="privacy-options data-v-c520b992"><block wx:for="{{privacyOptions}}" wx:for-item="option" wx:for-index="__i0__" wx:key="value"><view data-event-opts="{{[['tap',[['selectPrivacy',['$0'],[[['privacyOptions','value',option.value,'value']]]]]]]}}" class="privacy-option data-v-c520b992" bindtap="__e"><text class="option-text data-v-c520b992">{{option.label}}</text><block wx:if="{{postForm.privacy===option.value}}"><u-icon vue-id="{{('108544af-16-'+__i0__)+','+('108544af-14')}}" name="checkmark" size="20" color="#3b5598" class="data-v-c520b992" bind:__l="__l"></u-icon></block></view></block></view></view></u-popup></view>