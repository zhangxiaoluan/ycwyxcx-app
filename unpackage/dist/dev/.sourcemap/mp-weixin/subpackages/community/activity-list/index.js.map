{"version":3,"sources":["uni-app:///main.js","webpack:////Users/salvater/web/kai-nan/zhi-hui-wu-ye/ycwyxcx-app/subpackages/community/activity-list/index.vue?156b","webpack:////Users/salvater/web/kai-nan/zhi-hui-wu-ye/ycwyxcx-app/subpackages/community/activity-list/index.vue?462e","webpack:////Users/salvater/web/kai-nan/zhi-hui-wu-ye/ycwyxcx-app/subpackages/community/activity-list/index.vue?64f9","webpack:////Users/salvater/web/kai-nan/zhi-hui-wu-ye/ycwyxcx-app/subpackages/community/activity-list/index.vue?ffae","uni-app:///subpackages/community/activity-list/index.vue","webpack:////Users/salvater/web/kai-nan/zhi-hui-wu-ye/ycwyxcx-app/subpackages/community/activity-list/index.vue?7f8b","webpack:////Users/salvater/web/kai-nan/zhi-hui-wu-ye/ycwyxcx-app/subpackages/community/activity-list/index.vue?f12a"],"names":["wx","__webpack_require_UNI_MP_PLUGIN__","__webpack_require__","createPage","Page","data","searchKeyword","loading","posts","page","size","hasMore","searchTimer","onLoad","onPullDownRefresh","onReachBottom","methods","loadPosts","reset","params","keyword","response","records","console","newPosts","uni","title","icon","refreshPosts","loadMore","onSearchInput","clearTimeout","toggleLike","post","previewImage","filter","map","urls","current","sharePost","itemList","success","shareToFriend","generatePoster","showActionSheet","action","deletePost","content","res","index","goToPublish","url","goToPostDetail","getStatusText","getStatusClass","getImageGridClass","formatTime"],"mappings":";;;;;;;;;;;;;AAAA;AAGA;AACA;AAHA;AACAA,EAAE,CAACC,iCAAiC,GAAGC,mBAAmB;AAG1DC,UAAU,CAACC,cAAI,CAAC,C;;;;;;;;;;;;;ACLhB;AAAA;AAAA;AAAA;AAAA;AAAA;AAA8H;AAC9H;AACyD;AACL;AACsC;;;AAG1F;AACsN;AACtN,gBAAgB,iNAAU;AAC1B,EAAE,2EAAM;AACR,EAAE,4FAAM;AACR,EAAE,qGAAe;AACjB;AACA;AACA;AACA;AACA;AACA,EAAE,gGAAU;AACZ;AACA;;AAEA;AACe,gF;;;;;;;;;;;;ACvBf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;;;;;;;;;;;;ACAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA,aAAa,iSAEN;AACP,KAAK;AACL;AACA,aAAa,iVAEN;AACP,KAAK;AACL;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW;AACX;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;ACrFA;AAAA;AAAA;AAAA;AAAi2B,CAAgB,myBAAG,EAAC,C;;;;;;;;;;;;;;;;;;;;;;ACwHr3B;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;eAYA;EACAC;IACA;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;IACA;EACA;EACAC;IACA;EACA;EACAC;IACA;EACA;EACAC;IACA;MACA;IACA;EACA;EACAC;IACA;IACAC;MAAA;QAAA;MAAA;QAAA;QAAA;UAAA;YAAA;cAAA;gBAAAC;gBAAA,KACA;kBAAA;kBAAA;gBAAA;gBAAA;cAAA;gBAEA;kBACA;kBACA;gBACA;gBAEA;gBAAA;gBAGAC;kBACAV;kBACAC;kBACAU;gBACA;gBAAA;gBAAA,OAEA;cAAA;gBAAAC;gBACAC;gBACAC;gBACAC;gBACA;kBACA;gBACA;kBACA;gBACA;gBAEA;gBACA;gBAAA;gBAAA;cAAA;gBAAA;gBAAA;gBAEAD;gBACAE;kBACAC;kBACAC;gBACA;cAAA;gBAAA;gBAEA;gBACA;kBACAF;gBACA;gBAAA;cAAA;cAAA;gBAAA;YAAA;UAAA;QAAA;MAAA;IAEA;IAEA;IACAG;MACA;IACA;IAEA;IACAC;MACA;QACA;MACA;IACA;IAEA;IACAC;MAAA;MACA;QACAC;MACA;MAEA;QACA;MACA;IACA;IAEA;IACAC;MAAA;QAAA;UAAA;YAAA;cAAA;gBAAA;gBAAA,KAEAC;kBAAA;kBAAA;gBAAA;gBAAA;gBAAA,OACA;cAAA;gBACAA;gBAAA;gBAAA;cAAA;gBAAA;gBAAA,OAEA;cAAA;gBACAA;cAAA;gBAEAA;gBAAA;gBAAA;cAAA;gBAAA;gBAAA;gBAEAV;gBACAE;kBACAC;kBACAC;gBACA;cAAA;cAAA;gBAAA;YAAA;UAAA;QAAA;MAAA;IAEA;IAEA;IACAO;MACA,uBACAC;QAAA;MAAA,GACAC;QAAA;MAAA;MAEA;QACAX;UACAY;UACAC;QACA;MACA;IACA;IAEA;IACAC;MAAA;MACAd;QACAe;QACAC;UACA;YACA;YACA;UACA;YACA;YACA;UACA;QACA;MACA;IACA;IAEA;IACAC;MACA;MACAjB;QACAC;QACAC;MACA;IACA;IAEA;IACAgB;MACA;MACAlB;QACAC;QACAC;MACA;IACA;IAEA;IACAiB;MAAA;MACA;MACA;QACAJ;MACA;MACA;QACAA;MACA;MAEA;MAEAf;QACAe;QACAC;UAAA;YAAA;YAAA;cAAA;gBAAA;kBAAA;oBACAI;oBAEA;sBACA;sBACApB;wBACAC;wBACAC;sBACA;oBACA;sBACA;oBACA;kBAAA;kBAAA;oBAAA;gBAAA;cAAA;YAAA;UAAA,CACA;UAAA;YAAA;UAAA;UAAA;QAAA;MACA;IACA;IAEA;IACAmB;MAAA;MACArB;QACAC;QACAqB;QACAN;UAAA;YAAA;YAAA;cAAA;gBAAA;kBAAA;oBAAA,KACAO;sBAAA;sBAAA;oBAAA;oBAAA;oBAAA;oBAAA,OAEA;kBAAA;oBACAC;sBAAA;oBAAA;oBACA;sBACA;oBACA;oBACAxB;sBACAC;sBACAC;oBACA;oBAAA;oBAAA;kBAAA;oBAAA;oBAAA;oBAEAJ;oBACAE;sBACAC;sBACAC;oBACA;kBAAA;kBAAA;oBAAA;gBAAA;cAAA;YAAA;UAAA,CAGA;UAAA;YAAA;UAAA;UAAA;QAAA;MACA;IACA;IAEA;IACAuB;MACAzB;QACA0B;MACA;IACA;IAEA;IACAC;MAAA;MACA;MACA;QACAD;MACA;MACA1B;QACA0B;MACA;IACA;IAEA;IACAE;MACA;QACA;QACA;QACA;QACA;MACA;MACA;IACA;IAEA;IACAC;MACA;QACA;QACA;QACA;QACA;MACA;MACA;IACA;IAEA;IACAC;MACA;MACA;MACA;MACA;IACA;IAEA;IACAC;MACA;MACA;MACA;MAEA;MACA;MACA;MAEA;QACA;MACA;QACA;MACA;QACA;MACA;QACA;MACA;QACA;MACA;IACA;EACA;AACA;AAAA,2B;;;;;;;;;;;;;ACraA;AAAA;AAAA;AAAA;AAAgnD,CAAgB,07CAAG,EAAC,C;;;;;;;;;;;ACApoD;AACA,OAAO,KAAU,EAAE,kBAKd","file":"subpackages/community/activity-list/index.js","sourcesContent":["import 'uni-pages';\n// @ts-ignore\nwx.__webpack_require_UNI_MP_PLUGIN__ = __webpack_require__;\nimport Vue from 'vue'\nimport Page from './subpackages/community/activity-list/index.vue'\ncreatePage(Page)","import { render, staticRenderFns, recyclableRender, components } from \"./index.vue?vue&type=template&id=0156f9f9&scoped=true&\"\nvar renderjs\nimport script from \"./index.vue?vue&type=script&lang=js&\"\nexport * from \"./index.vue?vue&type=script&lang=js&\"\nimport style0 from \"./index.vue?vue&type=style&index=0&id=0156f9f9&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"0156f9f9\",\n  null,\n  false,\n  components,\n  renderjs\n)\n\ncomponent.options.__file = \"subpackages/community/activity-list/index.vue\"\nexport default component.exports","export * from \"-!../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--17-0!../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/template.js!../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-uni-app-loader/page-meta.js!../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./index.vue?vue&type=template&id=0156f9f9&scoped=true&\"","var components\ntry {\n  components = {\n    uIcon: function () {\n      return import(\n        /* webpackChunkName: \"uni_modules/uview-ui/components/u-icon/u-icon\" */ \"@/uni_modules/uview-ui/components/u-icon/u-icon.vue\"\n      )\n    },\n    uLoadingIcon: function () {\n      return import(\n        /* webpackChunkName: \"uni_modules/uview-ui/components/u-loading-icon/u-loading-icon\" */ \"@/uni_modules/uview-ui/components/u-loading-icon/u-loading-icon.vue\"\n      )\n    },\n  }\n} catch (e) {\n  if (\n    e.message.indexOf(\"Cannot find module\") !== -1 &&\n    e.message.indexOf(\".vue\") !== -1\n  ) {\n    console.error(e.message)\n    console.error(\"1. 排查组件名称拼写是否正确\")\n    console.error(\n      \"2. 排查组件是否符合 easycom 规范，文档：https://uniapp.dcloud.net.cn/collocation/pages?id=easycom\"\n    )\n    console.error(\n      \"3. 若组件不符合 easycom 规范，需手动引入，并在 components 中注册该组件\"\n    )\n  } else {\n    throw e\n  }\n}\nvar render = function () {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n  var l1 = _vm.__map(_vm.posts, function (post, __i0__) {\n    var $orig = _vm.__get_orig(post)\n    var m0 = _vm.formatTime(post.createdAt)\n    var m1 = _vm.getStatusText(post.status)\n    var g0 = post.mediaList && post.mediaList.length > 0\n    var l0 =\n      g0 && post.mediaList[0].type === 0\n        ? _vm.__map(post.mediaList.slice(0, 9), function (media, index) {\n            var $orig = _vm.__get_orig(media)\n            var g1 = post.mediaList.length\n            var g2 = !(g1 === 1) ? post.mediaList.length : null\n            var g3 = !(g1 === 1) && !(g2 === 2) ? post.mediaList.length : null\n            return {\n              $orig: $orig,\n              g1: g1,\n              g2: g2,\n              g3: g3,\n            }\n          })\n        : null\n    var g4 = g0 && post.mediaList[0].type === 0 ? post.mediaList.length : null\n    var g5 =\n      g0 && post.mediaList[0].type === 0 && g4 > 9\n        ? post.mediaList.length\n        : null\n    return {\n      $orig: $orig,\n      m0: m0,\n      m1: m1,\n      g0: g0,\n      l0: l0,\n      g4: g4,\n      g5: g5,\n    }\n  })\n  var g6 = _vm.posts.length === 0 && !_vm.loading\n  var g7 = !_vm.hasMore && _vm.posts.length > 0\n  _vm.$mp.data = Object.assign(\n    {},\n    {\n      $root: {\n        l1: l1,\n        g6: g6,\n        g7: g7,\n      },\n    }\n  )\n}\nvar recyclableRender = false\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns, recyclableRender, components }","import mod from \"-!../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--13-1!../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./index.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--13-1!../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./index.vue?vue&type=script&lang=js&\"","<template>\r\n  <view class=\"community-page\">\r\n    <!-- 页面标题 -->\r\n    <view class=\"page-header\">\r\n      <text class=\"page-title\">社区动态</text>\r\n      <text class=\"page-subtitle\">分享社区生活，共建和谐邻里</text>\r\n      <view class=\"publish-btn\" @click=\"goToPublish\">\r\n        <u-icon name=\"plus\" size=\"16\" color=\"#fff\"></u-icon>\r\n        <text class=\"publish-text\">发布</text>\r\n      </view>\r\n    </view>\r\n\r\n    <!-- 搜索栏 -->\r\n    <view class=\"search-section\">\r\n      <view class=\"search-box\">\r\n        <u-icon name=\"search\" size=\"20\" color=\"#999\"></u-icon>\r\n        <input\r\n          class=\"search-input\"\r\n          placeholder=\"搜索社区动态\"\r\n          v-model=\"searchKeyword\"\r\n          @input=\"onSearchInput\"\r\n        />\r\n      </view>\r\n    </view>\r\n\r\n    <!-- 动态列表 -->\r\n    <view class=\"post-list\">\r\n      <view class=\"post-item\" v-for=\"post in posts\" :key=\"post.id\" @click=\"goToPostDetail(post)\">\r\n        <!-- 用户信息 -->\r\n        <view class=\"user-info\">\r\n          <image :src=\"post.userAvatar || '/static/image/default-avatar.png'\" class=\"user-avatar\"></image>\r\n          <view class=\"user-details\">\r\n            <text class=\"user-name\">{{ post.userName }}</text>\r\n            <text class=\"post-time\">{{ formatTime(post.createdAt) }}</text>\r\n          </view>\r\n          <view class=\"post-status\" :class=\"'post-status-' + post.status\">\r\n            {{ getStatusText(post.status) }}\r\n          </view>\r\n        </view>\r\n\r\n        <!-- 动态内容 -->\r\n        <view class=\"post-content\">\r\n          <text class=\"post-title\" v-if=\"post.title\">{{ post.title }}</text>\r\n          <text class=\"post-text\">{{ post.content }}</text>\r\n        </view>\r\n\r\n        <!-- 媒体内容 -->\r\n        <view class=\"media-section\" v-if=\"post.mediaList && post.mediaList.length > 0\">\r\n          <!-- 图片网格 -->\r\n          <view class=\"image-grid\" v-if=\"post.mediaList[0].type === 0\">\r\n            <view\r\n              class=\"image-item\"\r\n              :class=\"post.mediaList.length === 1 ? 'grid-single' : (post.mediaList.length === 2 ? 'grid-double' : (post.mediaList.length <= 4 ? 'grid-four' : 'grid-nine'))\"\r\n              v-for=\"(media, index) in post.mediaList.slice(0, 9)\"\r\n              :key=\"media.id\"\r\n              @click.stop=\"previewImage(post.mediaList, index)\">\r\n              <image :src=\"media.thumbnail || media.url\" mode=\"aspectFill\" class=\"media-image\"></image>\r\n            </view>\r\n            <view class=\"more-images\" v-if=\"post.mediaList.length > 9\" @click.stop=\"previewImage(post.mediaList, 9)\">\r\n              <text>+{{ post.mediaList.length - 9 }}</text>\r\n            </view>\r\n          </view>\r\n          <!-- 视频 -->\r\n          <view class=\"video-item\" v-else-if=\"post.mediaList[0].type === 1\">\r\n            <image :src=\"post.mediaList[0].thumbnail\" mode=\"aspectFill\" class=\"video-thumbnail\"></image>\r\n            <view class=\"video-play-btn\">\r\n              <u-icon name=\"play-circle-fill\" size=\"60\" color=\"rgba(255,255,255,0.8)\"></u-icon>\r\n            </view>\r\n          </view>\r\n        </view>\r\n\r\n        <!-- 互动区域 -->\r\n        <view class=\"interaction-section\">\r\n          <view class=\"interaction-item\" @click.stop=\"toggleLike(post)\">\r\n            <u-icon :name=\"post.isLiked ? 'heart-fill' : 'heart'\" :color=\"post.isLiked ? '#ff4d4f' : '#999'\" size=\"20\"></u-icon>\r\n            <text class=\"interaction-text\" :class=\"{ liked: post.isLiked }\">{{ post.likes || 0 }}</text>\r\n          </view>\r\n          <view class=\"interaction-item\" @click.stop=\"goToPostDetail(post, 'comment')\">\r\n            <u-icon name=\"eye\" size=\"20\" color=\"#999\"></u-icon>\r\n            <text class=\"interaction-text\">{{ post.commentsCount || 0 }}</text>\r\n          </view>\r\n          <view class=\"interaction-item\" @click.stop=\"sharePost(post)\">\r\n            <u-icon name=\"share\" size=\"20\" color=\"#999\"></u-icon>\r\n            <text class=\"interaction-text\">分享</text>\r\n          </view>\r\n          <!-- 操作按钮（仅自己的动态显示） -->\r\n          <view class=\"post-actions\" v-if=\"post.canEdit || post.canDelete\" @click.stop=\"showActionSheet(post)\">\r\n            <u-icon name=\"more-horizontal\" size=\"20\" color=\"#999\"></u-icon>\r\n          </view>\r\n        </view>\r\n      </view>\r\n    </view>\r\n\r\n    <!-- 空状态 -->\r\n    <view class=\"empty-state\" v-if=\"posts.length === 0 && !loading\">\r\n      <u-icon name=\"message-circle\" size=\"60\" color=\"#ccc\"></u-icon>\r\n      <text class=\"empty-text\">暂无动态</text>\r\n      <text class=\"empty-desc\">快来发布第一条动态吧</text>\r\n      <button class=\"empty-publish-btn\" @click=\"goToPublish\">发布动态</button>\r\n    </view>\r\n\r\n    <!-- 加载状态 -->\r\n    <view class=\"loading-section\" v-if=\"loading\">\r\n      <u-loading-icon mode=\"flower\" size=\"40\"></u-loading-icon>\r\n      <text class=\"loading-text\">加载中...</text>\r\n    </view>\r\n\r\n    <!-- 加载更多 -->\r\n    <view class=\"load-more\" v-if=\"hasMore && !loading\">\r\n      <text class=\"load-more-text\" @click=\"loadMore\">加载更多</text>\r\n    </view>\r\n\r\n    <!-- 到底了 -->\r\n    <view class=\"no-more\" v-if=\"!hasMore && posts.length > 0\">\r\n      <text class=\"no-more-text\">已经到底了</text>\r\n    </view>\r\n  </view>\r\n</template>\r\n\r\n<script>\r\nimport {\r\n  getPostList,\r\n  getPostDetail,\r\n  likePost,\r\n  unlikePost,\r\n  createPost,\r\n  getMyPosts,\r\n  deletePost,\r\n  getLikedPosts,\r\n  uploadMedia\r\n} from '@/api/list/activity-list.js'\r\n\r\nexport default {\r\n  data() {\r\n    return {\r\n      searchKeyword: '',\r\n      loading: false,\r\n      posts: [],\r\n      page: 1,\r\n      size: 10,\r\n      hasMore: true,\r\n      searchTimer: null\r\n    }\r\n  },\r\n  onLoad() {\r\n    this.loadPosts()\r\n  },\r\n  onPullDownRefresh() {\r\n    this.refreshPosts()\r\n  },\r\n  onReachBottom() {\r\n    if (this.hasMore && !this.loading) {\r\n      this.loadMore()\r\n    }\r\n  },\r\n  methods: {\r\n    // 加载动态列表\r\n    async loadPosts(reset = false) {\r\n      if (this.loading) return\r\n\r\n      if (reset) {\r\n        this.page = 1\r\n        this.hasMore = true\r\n      }\r\n\r\n      this.loading = true\r\n\r\n      try {\r\n        const params = {\r\n          page: this.page,\r\n          size: this.size,\r\n          keyword: this.searchKeyword\r\n        }\r\n\r\n        const response = await getPostList(params)\r\n        let records = response.records || []\r\n        console.log(response)\r\n        const newPosts = records\r\n        if (reset) {\r\n          this.posts = newPosts\r\n        } else {\r\n          this.posts = [...this.posts, ...newPosts]\r\n        }\r\n\r\n        this.hasMore = newPosts.length >= this.size\r\n        this.page++\r\n      } catch (error) {\r\n        console.error('加载动态列表失败:', error)\r\n        uni.showToast({\r\n          title: '加载失败',\r\n          icon: 'none'\r\n        })\r\n      } finally {\r\n        this.loading = false\r\n        if (reset) {\r\n          uni.stopPullDownRefresh()\r\n        }\r\n      }\r\n    },\r\n\r\n    // 刷新列表\r\n    refreshPosts() {\r\n      this.loadPosts(true)\r\n    },\r\n\r\n    // 加载更多\r\n    loadMore() {\r\n      if (this.hasMore && !this.loading) {\r\n        this.loadPosts(false)\r\n      }\r\n    },\r\n\r\n    // 搜索输入\r\n    onSearchInput() {\r\n      if (this.searchTimer) {\r\n        clearTimeout(this.searchTimer)\r\n      }\r\n\r\n      this.searchTimer = setTimeout(() => {\r\n        this.refreshPosts()\r\n      }, 500)\r\n    },\r\n\r\n    // 切换点赞状态\r\n    async toggleLike(post) {\r\n      try {\r\n        if (post.isLiked) {\r\n          await unlikePost(post.id)\r\n          post.likes = Math.max(0, (post.likes || 0) - 1)\r\n        } else {\r\n          await likePost(post.id)\r\n          post.likes = (post.likes || 0) + 1\r\n        }\r\n        post.isLiked = !post.isLiked\r\n      } catch (error) {\r\n        console.error('操作失败:', error)\r\n        uni.showToast({\r\n          title: '操作失败',\r\n          icon: 'none'\r\n        })\r\n      }\r\n    },\r\n\r\n    // 预览图片\r\n    previewImage(mediaList, index) {\r\n      const images = mediaList\r\n        .filter(media => media.type === 0)\r\n        .map(media => media.url)\r\n\r\n      if (images.length > 0) {\r\n        uni.previewImage({\r\n          urls: images,\r\n          current: index\r\n        })\r\n      }\r\n    },\r\n\r\n    // 分享动态\r\n    sharePost(post) {\r\n      uni.showActionSheet({\r\n        itemList: ['分享给好友', '生成海报'],\r\n        success: (res) => {\r\n          if (res.tapIndex === 0) {\r\n            // 分享给好友\r\n            this.shareToFriend(post)\r\n          } else if (res.tapIndex === 1) {\r\n            // 生成海报\r\n            this.generatePoster(post)\r\n          }\r\n        }\r\n      })\r\n    },\r\n\r\n    // 分享给好友\r\n    shareToFriend(post) {\r\n      // TODO: 实现分享功能\r\n      uni.showToast({\r\n        title: '分享功能开发中',\r\n        icon: 'none'\r\n      })\r\n    },\r\n\r\n    // 生成海报\r\n    generatePoster(post) {\r\n      // TODO: 实现海报生成功能\r\n      uni.showToast({\r\n        title: '海报生成功能开发中',\r\n        icon: 'none'\r\n      })\r\n    },\r\n\r\n    // 显示操作菜单\r\n    showActionSheet(post) {\r\n      const itemList = []\r\n      if (post.canEdit) {\r\n        itemList.push('编辑')\r\n      }\r\n      if (post.canDelete) {\r\n        itemList.push('删除')\r\n      }\r\n\r\n      if (itemList.length === 0) return\r\n\r\n      uni.showActionSheet({\r\n        itemList,\r\n        success: async (res) => {\r\n          const action = itemList[res.tapIndex]\r\n\r\n          if (action === '编辑') {\r\n            // TODO: 跳转到编辑页面\r\n            uni.showToast({\r\n              title: '编辑功能开发中',\r\n              icon: 'none'\r\n            })\r\n          } else if (action === '删除') {\r\n            this.deletePost(post)\r\n          }\r\n        }\r\n      })\r\n    },\r\n\r\n    // 删除动态\r\n    deletePost(post) {\r\n      uni.showModal({\r\n        title: '确认删除',\r\n        content: '确定要删除这条动态吗？',\r\n        success: async (res) => {\r\n          if (res.confirm) {\r\n            try {\r\n              await deletePost(post.id)\r\n              const index = this.posts.findIndex(p => p.id === post.id)\r\n              if (index > -1) {\r\n                this.posts.splice(index, 1)\r\n              }\r\n              uni.showToast({\r\n                title: '删除成功',\r\n                icon: 'success'\r\n              })\r\n            } catch (error) {\r\n              console.error('删除失败:', error)\r\n              uni.showToast({\r\n                title: '删除失败',\r\n                icon: 'none'\r\n              })\r\n            }\r\n          }\r\n        }\r\n      })\r\n    },\r\n\r\n    // 跳转到发布页面\r\n    goToPublish() {\r\n      uni.navigateTo({\r\n        url: '/subpackages/community/activity-list/apublish'\r\n      })\r\n    },\r\n\r\n    // 跳转到详情页\r\n    goToPostDetail(post, action = '') {\r\n      let url = `/subpackages/community/post-detail?id=${post.id}`\r\n      if (action) {\r\n        url += `&action=${action}`\r\n      }\r\n      uni.navigateTo({\r\n        url\r\n      })\r\n    },\r\n\r\n    // 获取状态文本\r\n    getStatusText(status) {\r\n      const statusMap = {\r\n        0: '正常',\r\n        1: '待审核',\r\n        2: '已拒绝',\r\n        3: '已删除'\r\n      }\r\n      return statusMap[status] || '未知'\r\n    },\r\n\r\n    // 获取状态样式类\r\n    getStatusClass(status) {\r\n      const classMap = {\r\n        0: 'status-normal',\r\n        1: 'status-pending',\r\n        2: 'status-rejected',\r\n        3: 'status-deleted'\r\n      }\r\n      return classMap[status] || ''\r\n    },\r\n\r\n    // 获取图片网格样式类\r\n    getImageGridClass(count) {\r\n      if (count === 1) return 'grid-single'\r\n      if (count === 2) return 'grid-double'\r\n      if (count <= 4) return 'grid-four'\r\n      return 'grid-nine'\r\n    },\r\n\r\n    // 格式化时间\r\n    formatTime(time) {\r\n      const now = new Date()\r\n      const postTime = new Date(time)\r\n      const diff = now - postTime\r\n\r\n      const minute = 60 * 1000\r\n      const hour = 60 * minute\r\n      const day = 24 * hour\r\n\r\n      if (diff < minute) {\r\n        return '刚刚'\r\n      } else if (diff < hour) {\r\n        return `${Math.floor(diff / minute)}分钟前`\r\n      } else if (diff < day) {\r\n        return `${Math.floor(diff / hour)}小时前`\r\n      } else if (diff < 7 * day) {\r\n        return `${Math.floor(diff / day)}天前`\r\n      } else {\r\n        return postTime.toLocaleDateString()\r\n      }\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n.community-page {\r\n  min-height: 100vh;\r\n  background-color: #f5f5f5;\r\n}\r\n\r\n.page-header {\r\n  background: linear-gradient(135deg, #3b5598 0%, #5a7dd8 100%);\r\n  padding: 40rpx 30rpx 30rpx;\r\n  color: white;\r\n  position: relative;\r\n\r\n  .page-title {\r\n    font-size: 36rpx;\r\n    font-weight: 600;\r\n    display: block;\r\n    margin-bottom: 10rpx;\r\n  }\r\n\r\n  .page-subtitle {\r\n    font-size: 24rpx;\r\n    opacity: 0.9;\r\n    display: block;\r\n  }\r\n\r\n  .publish-btn {\r\n    position: absolute;\r\n    right: 30rpx;\r\n    top: 50%;\r\n    transform: translateY(-50%);\r\n    display: flex;\r\n    align-items: center;\r\n    background: rgba(255, 255, 255, 0.2);\r\n    border-radius: 30rpx;\r\n    padding: 12rpx 20rpx;\r\n\r\n    .publish-text {\r\n      font-size: 24rpx;\r\n      margin-left: 8rpx;\r\n    }\r\n  }\r\n}\r\n\r\n.search-section {\r\n  background: white;\r\n  padding: 20rpx 30rpx;\r\n  margin-bottom: 20rpx;\r\n\r\n  .search-box {\r\n    display: flex;\r\n    align-items: center;\r\n    background-color: #f5f5f5;\r\n    border-radius: 30rpx;\r\n    padding: 16rpx 24rpx;\r\n\r\n    .search-input {\r\n      flex: 1;\r\n      font-size: 28rpx;\r\n      margin-left: 16rpx;\r\n    }\r\n  }\r\n}\r\n\r\n.post-list {\r\n  padding: 0 30rpx;\r\n\r\n  .post-item {\r\n    background: white;\r\n    border-radius: 16rpx;\r\n    margin-bottom: 20rpx;\r\n    padding: 30rpx;\r\n    box-shadow: 0 2rpx 10rpx rgba(0, 0, 0, 0.1);\r\n  }\r\n\r\n  .user-info {\r\n    display: flex;\r\n    align-items: center;\r\n    margin-bottom: 20rpx;\r\n\r\n    .user-avatar {\r\n      width: 80rpx;\r\n      height: 80rpx;\r\n      border-radius: 50%;\r\n      margin-right: 20rpx;\r\n    }\r\n\r\n    .user-details {\r\n      flex: 1;\r\n\r\n      .user-name {\r\n        font-size: 30rpx;\r\n        font-weight: 600;\r\n        color: #333;\r\n        display: block;\r\n      }\r\n\r\n      .post-time {\r\n        font-size: 24rpx;\r\n        color: #999;\r\n        display: block;\r\n        margin-top: 4rpx;\r\n      }\r\n    }\r\n\r\n    .post-status {\r\n      padding: 8rpx 16rpx;\r\n      border-radius: 20rpx;\r\n      font-size: 22rpx;\r\n      color: white;\r\n\r\n      &.post-status-0 {\r\n        background-color: #07c160;\r\n      }\r\n\r\n      &.post-status-1 {\r\n        background-color: #ff9500;\r\n      }\r\n\r\n      &.post-status-2 {\r\n        background-color: #ff4d4f;\r\n      }\r\n\r\n      &.post-status-3 {\r\n        background-color: #999;\r\n      }\r\n    }\r\n  }\r\n\r\n  .post-content {\r\n    margin-bottom: 20rpx;\r\n\r\n    .post-title {\r\n      font-size: 32rpx;\r\n      font-weight: 600;\r\n      color: #333;\r\n      display: block;\r\n      margin-bottom: 12rpx;\r\n    }\r\n\r\n    .post-text {\r\n      font-size: 28rpx;\r\n      color: #333;\r\n      line-height: 1.6;\r\n      display: block;\r\n    }\r\n  }\r\n\r\n  .media-section {\r\n    margin-bottom: 20rpx;\r\n\r\n    .image-grid {\r\n      display: flex;\r\n      flex-wrap: wrap;\r\n      gap: 8rpx;\r\n\r\n      .image-item {\r\n        border-radius: 12rpx;\r\n        overflow: hidden;\r\n\r\n        &.grid-single {\r\n          width: 100%;\r\n          height: 400rpx;\r\n        }\r\n\r\n        &.grid-double {\r\n          width: calc(50% - 4rpx);\r\n          height: 200rpx;\r\n        }\r\n\r\n        &.grid-four {\r\n          width: calc(50% - 4rpx);\r\n          height: 200rpx;\r\n        }\r\n\r\n        &.grid-nine {\r\n          width: calc(33.33% - 6rpx);\r\n          height: 180rpx;\r\n        }\r\n\r\n        .media-image {\r\n          width: 100%;\r\n          height: 100%;\r\n        }\r\n      }\r\n\r\n      .more-images {\r\n        display: flex;\r\n        align-items: center;\r\n        justify-content: center;\r\n        background-color: #f0f0f0;\r\n        border-radius: 12rpx;\r\n        width: calc(33.33% - 6rpx);\r\n        height: 180rpx;\r\n        font-size: 24rpx;\r\n        color: #666;\r\n      }\r\n    }\r\n\r\n    .video-item {\r\n      position: relative;\r\n      border-radius: 12rpx;\r\n      overflow: hidden;\r\n      height: 400rpx;\r\n\r\n      .video-thumbnail {\r\n        width: 100%;\r\n        height: 100%;\r\n      }\r\n\r\n      .video-play-btn {\r\n        position: absolute;\r\n        top: 50%;\r\n        left: 50%;\r\n        transform: translate(-50%, -50%);\r\n      }\r\n    }\r\n  }\r\n\r\n  .interaction-section {\r\n    display: flex;\r\n    align-items: center;\r\n    border-top: 1rpx solid #f0f0f0;\r\n    padding-top: 20rpx;\r\n\r\n    .interaction-item {\r\n      display: flex;\r\n      align-items: center;\r\n      margin-right: 40rpx;\r\n\r\n      .interaction-text {\r\n        font-size: 26rpx;\r\n        color: #999;\r\n        margin-left: 8rpx;\r\n\r\n        &.liked {\r\n          color: #ff4d4f;\r\n        }\r\n      }\r\n    }\r\n\r\n    .post-actions {\r\n      margin-left: auto;\r\n    }\r\n  }\r\n}\r\n\r\n.empty-state {\r\n  display: flex;\r\n  flex-direction: column;\r\n  align-items: center;\r\n  justify-content: center;\r\n  padding: 100rpx 30rpx;\r\n\r\n  .empty-text {\r\n    font-size: 28rpx;\r\n    color: #666;\r\n    margin: 20rpx 0 10rpx;\r\n  }\r\n\r\n  .empty-desc {\r\n    font-size: 24rpx;\r\n    color: #999;\r\n    margin-bottom: 30rpx;\r\n  }\r\n\r\n  .empty-publish-btn {\r\n    background-color: #3b5598;\r\n    color: white;\r\n    border: none;\r\n    border-radius: 30rpx;\r\n    padding: 16rpx 40rpx;\r\n    font-size: 28rpx;\r\n  }\r\n}\r\n\r\n.loading-section {\r\n  display: flex;\r\n  flex-direction: column;\r\n  align-items: center;\r\n  justify-content: center;\r\n  padding: 80rpx 30rpx;\r\n\r\n  .loading-text {\r\n    font-size: 26rpx;\r\n    color: #666;\r\n    margin-top: 20rpx;\r\n  }\r\n}\r\n\r\n.load-more {\r\n  text-align: center;\r\n  padding: 30rpx;\r\n\r\n  .load-more-text {\r\n    font-size: 26rpx;\r\n    color: #3b5598;\r\n    padding: 16rpx 40rpx;\r\n    background-color: #f0f5ff;\r\n    border-radius: 30rpx;\r\n    display: inline-block;\r\n  }\r\n}\r\n\r\n.no-more {\r\n  text-align: center;\r\n  padding: 30rpx;\r\n\r\n  .no-more-text {\r\n    font-size: 24rpx;\r\n    color: #999;\r\n  }\r\n}\r\n</style>\r\n","import mod from \"-!../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--8-oneOf-1-2!../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-3!../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/sass-loader/dist/cjs.js??ref--8-oneOf-1-4!../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--8-oneOf-1-5!../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./index.vue?vue&type=style&index=0&id=0156f9f9&lang=scss&scoped=true&\"; export default mod; export * from \"-!../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--8-oneOf-1-2!../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-3!../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/sass-loader/dist/cjs.js??ref--8-oneOf-1-4!../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--8-oneOf-1-5!../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./index.vue?vue&type=style&index=0&id=0156f9f9&lang=scss&scoped=true&\"","// extracted by mini-css-extract-plugin\n    if(module.hot) {\n      // 1766736710466\n      var cssReload = require(\"/Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/hmr/hotModuleReplacement.js\")(module.id, {\"hmr\":true,\"publicPath\":\"/\",\"locals\":false});\n      module.hot.dispose(cssReload);\n      module.hot.accept(undefined, cssReload);\n    }\n  "],"sourceRoot":""}